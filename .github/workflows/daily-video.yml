name: Daily Religious Video Generator

on:
  schedule:
    # ÙƒÙ„ ÙŠÙˆÙ… Ø§Ù„Ø³Ø§Ø¹Ø© 9 ØµØ¨Ø§Ø­Ø§Ù‹ Ø¨ØªÙˆÙ‚ÙŠØª UTC
    - cron: '0 9 * * *'

  # ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø£ÙŠØ¶Ø§Ù‹
  workflow_dispatch:
    inputs:
      video_topic:
        description: 'Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (ÙØ§Ø±Øº = AI ÙŠØ®ØªØ§Ø±)'
        required: false
        default: ''

jobs:
  generate-and-publish-video:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸš€ ØªÙˆÙ„ÙŠØ¯ ÙˆÙ†Ø´Ø± ÙÙŠØ¯ÙŠÙˆ Ø¯ÙŠÙ†ÙŠ
        run: |
          echo "ğŸ¤– Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… AI Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø¯ÙŠÙ†ÙŠØ©..."

          curl -X POST 'https://backend.composio.dev/api/v1/cli/execute-recipe' \
          -H 'Content-Type: application/json' \
          -d '{
            "recipeId": "rcp_GA3Odr3U5NZ-",
            "input": {
              "video_topic": "${{ github.event.inputs.video_topic || '' }}",
              "report_email": "hamzawatfa25@gmail.com",
              "channel_handle": "@hamzawatfa-c3f"
            }
          }'

          echo "âœ… ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!"
          echo "ğŸ“§ ØªÙÙ‚Ø¯ Ø¨Ø±ÙŠØ¯Ùƒ Ù„Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙØµÙŠÙ„ÙŠ"

      - name: ğŸ“Š ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©
        if: always()
        run: |
          echo "ğŸ“ ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… ÙÙŠ: $(date)"
          echo "ğŸ¬ Recipe ID: rcp_GA3Odr3U5NZ-"
